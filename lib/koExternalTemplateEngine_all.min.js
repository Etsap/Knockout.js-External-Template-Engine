(function(a,b){var c={};a.trafficCop=function(b,d){var e=b,f;arguments.length===2&&(e=a.extend(!0,d,{url:b})),f=JSON.stringify(e);if(c[f]){c[f].successCallbacks.push(e.success),c[f].errorCallbacks.push(e.error);return}var g=function(){delete c[f]},h={successCallbacks:[e.success],errorCallbacks:[e.error],success:function(){var b=arguments;a.each(a(c[f].successCallbacks),function(a,c){c.apply(null,b)}),g()},error:function(){var b=arguments;a.each(a(c[f].errorCallbacks),function(a,c){c.apply(null,b)}),g()}};return c[f]=a.extend(!0,{},e,h),a.ajax(c[f])}})(jQuery),function(a,b,c){var d={templates:{},storeTemplate:function(a,b){this.templates[a]=b},getTemplate:function(a){return this.templates[a]},purge:function(){this.templates={}}},e={templateIds:[],storeTemplate:function(a,b){var c=document.getElementById(a);c===null&&(this.templateIds.push(a),c=document.createElement("script"),c.type="text/html",c.id=a,document.body.appendChild(c)),c.text=b},getTemplate:function(a){return document.getElementById(a)},purge:function(){for(var a=0;a<this.templateIds.length;a++)document.body.removeChild(document.getElementById(this.templateIds[a]));this.templateIds=[]}},f="<div class='infuser-error'>The template <a href='{TEMPLATEURL}'>{TEMPLATEID}</a> could not be loaded. {STATUS}</div>",g=function(a,b,c){return f.replace("{STATUS}",a).replace("{TEMPLATEID}",b).replace("{TEMPLATEURL}",c)},h=[],i={getTemplatePath:function(a){var b=j.config.templatePrefix+a+j.config.templateSuffix;return j.config.templateUrl===c||j.config.templateUrl===""?b:j.config.templateUrl+"/"+b},templateGetSuccess:function(a,b){return function(c){j.store.storeTemplate(a,c),b(j.store.getTemplate(a))}},templateGetError:function(b,c,d){return function(e){a.inArray(b,h)===-1&&h.push(b);var f=g("HTTP Status code: "+e.status,b,c);j.store.storeTemplate(b,f),d(j.store.getTemplate(b))}}},j={storageOptions:{hash:d,script:e},store:d,config:{templateUrl:"",templateSuffix:".html",templatePrefix:""},defaults:{target:function(a){return"#"+a},loadingTemplate:{content:'<div class="infuser-loading">Loading...</div>',transitionIn:function(b){var c=this,d=a(b);d.hide(),d.html(c.content),d.fadeIn()},transitionOut:function(b){a(b).html("")}},postRender:function(a){},preRender:function(a,b){},render:function(b,c){var d=a(b);d.children().length===0?d.append(a(c)):d.children().replaceWith(a(c))},bindingInstruction:function(a,b){return a},useLoadingTemplate:!0},get:function(b,c){var d=this.store.getTemplate(b),e,f;!d||a.inArray(b,h)!==-1?(e=i.getTemplatePath(b),f={async:!0,url:e,dataType:"html",type:"GET",success:i.templateGetSuccess(b,c),error:i.templateGetError(b,e,c)},a.trafficCop(f)):c(d)},getSync:function(b){var c=this.store.getTemplate(b),d,e,f;if(!c||a.inArray(b,h)!==-1)d=i.getTemplatePath(b),e=null,f={async:!1,url:d,dataType:"html",type:"GET",success:function(a){e=a},error:function(c){a.inArray(b)===-1&&h.push(b),e=g("HTTP Status code: exception.status",b,d)}},a.ajax(f),e===null?e=g("An unknown error occurred.",b,d):(this.store.storeTemplate(b,e),c=this.store.getTemplate(b));return c},infuse:function(b,c){var d=this,e=a.extend({},d.defaults,c),f=typeof e.target=="function"?e.target(b):e.target;e.useLoadingTemplate&&e.loadingTemplate.transitionIn(f),d.get(b,function(a){var b=a;e.preRender(f,b),b=e.bindingInstruction(b,e.model),e.useLoadingTemplate&&e.loadingTemplate.transitionOut(f),e.render(f,b),e.postRender(f)})}};b.infuser=j}(jQuery,window),function(a,b,c,d,e){var f=function(a){this.templateId=a,this.loaded=!1,this.template=b.observable(d.defaults.loadingTemplate.content),this.template.data={}};b.utils.extend(f.prototype,{data:function(a,b){if(arguments.length===1)return a==="precompiled"&&this.template(),this.template.data[a];this.template.data[a]=b},text:function(a){this.loaded||this.getTemplate();if(arguments.length===0)return this.template();this.template(arguments[0])},getTemplate:function(){var a=this;d.get(a.templateId,function(b){a.data("precompiled",null),a.template(b),a.loaded=!0})}});var g=function(a){var c=a?new a:new b.nativeTemplateEngine;return c.templates={},c.makeTemplateSource=function(a){if(typeof a=="string"){var d=document.getElementById(a);return d?new b.templateSources.domElement(d):(c.templates[a]||(c.templates[a]=new f(a)),c.templates[a])}if(a.nodeType==1||a.nodeType==8)return new b.templateSources.anonymousTemplate(a)},c};b.KoExternalTemplateEngine=g,c.tmpl&&c.tmpl.tag.tmpl.open.toString().indexOf("__")>=0?b.setTemplateEngine(new g(b.jqueryTmplTemplateEngine)):b.setTemplateEngine(new g)}(window,ko,jQuery,infuser)